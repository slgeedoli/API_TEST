<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ì¹´ì¹´ì˜¤ë§µ ë‚´ ìœ„ì¹˜ ê¸¸ì°¾ê¸°</title>
    <style>
        body { font-family: 'Malgun Gothic', sans-serif; margin: 0; padding: 20px; }
        
        .search-box { margin-bottom: 10px; padding: 15px; background: #f5f5f5; border-radius: 8px; }
        .input-group { margin-bottom: 10px; display: flex; align-items: center; gap: 5px; }
        
        label { font-weight: bold; width: 60px; }
        input { padding: 8px; width: 200px; border: 1px solid #ccc; border-radius: 4px; }
        
        button { padding: 8px 12px; cursor: pointer; border: none; border-radius: 4px; background-color: #ddd; }
        button:hover { background-color: #ccc; }
        
        /* ë²„íŠ¼ ìƒ‰ìƒ ì°¨ë³„í™” */
        .btn-search { background-color: #333; color: white; } /* ê²€ìƒ‰ ë²„íŠ¼: ì–´ë‘ìš´ ìƒ‰ */
        .btn-location { background-color: #2DB400; color: white; } /* ë‚´ ìœ„ì¹˜: ì´ˆë¡ìƒ‰ */
        .btn-path { background-color: #FEE500; color: black; font-weight: bold; width: 100%; padding: 12px; font-size: 16px; margin-top: 10px;}
        
        #map { width: 100%; height: 500px; border: 1px solid #ddd; margin-top: 20px; border-radius: 8px; }
        #status { font-size: 14px; color: #666; margin-top: 5px; }
    </style>
</head>
<body>

    <h2>ğŸ“ ì¹´ì¹´ì˜¤ë§µ ê¸¸ì°¾ê¸° (ë‚´ ìœ„ì¹˜ ì¶”ê°€)</h2>

    <div class="search-box">
        <div class="input-group">
            <label>ì¶œë°œì§€</label>
            <input type="text" id="startKeyword" placeholder="ì¥ì†Œ ê²€ìƒ‰ ë˜ëŠ” ë‚´ ìœ„ì¹˜ í´ë¦­">
            <button class="btn-search" onclick="searchLocation('start')">ê²€ìƒ‰</button>
            <button class="btn-location" onclick="setToCurrentLocation()">ğŸ“ ë‚´ ìœ„ì¹˜</button>
        </div>
        <div id="startResult" style="color:blue; font-size: 14px; margin-left: 65px; margin-bottom: 10px;">(ë¯¸ì„¤ì •)</div>

        <div class="input-group">
            <label>ë„ì°©ì§€</label>
            <input type="text" id="endKeyword" placeholder="ì˜ˆ: ê°•ë‚¨ì—­">
            <button class="btn-search" onclick="searchLocation('end')">ê²€ìƒ‰</button>
        </div>
        <div id="endResult" style="color:red; font-size: 14px; margin-left: 65px;">(ë¯¸ì„¤ì •)</div>

        <button class="btn-path" onclick="openPathFinding()">ğŸš€ ì¹´ì¹´ì˜¤ë§µìœ¼ë¡œ ê¸¸ì°¾ê¸° ì‹œì‘</button>
    </div>

    <div id="map"></div>

    <script type="text/javascript" src="https://dapi.kakao.com/v2/maps/sdk.js?appkey=66ae3efe79b3a691f03832967f0df6a2&libraries=services"></script>
    
    <script>
        // ì§€ë„ ìƒì„±
        var mapContainer = document.getElementById('map');
        var mapOption = {
            center: new kakao.maps.LatLng(37.566826, 126.9786567),
            level: 3
        };
        var map = new kakao.maps.Map(mapContainer, mapOption);
        
        // ì¥ì†Œ ê²€ìƒ‰ & ì£¼ì†Œ ë³€í™˜ ê°ì²´
        var ps = new kakao.maps.services.Places();
        var geocoder = new kakao.maps.services.Geocoder();

        var startPoint = { lat: null, lng: null, name: null, marker: null };
        var endPoint = { lat: null, lng: null, name: null, marker: null };
        var polyline = null;

        // [ê¸°ëŠ¥ 1] ë‚´ ìœ„ì¹˜ ì°¾ê¸° (ë¸Œë¼ìš°ì € GPS í™œìš©)
        function setToCurrentLocation() {
            if (navigator.geolocation) {
                // ì‚¬ìš©ìì—ê²Œ ìœ„ì¹˜ ì •ë³´ í—ˆìš© ìš”ì²­
                navigator.geolocation.getCurrentPosition(function(position) {
                    var lat = position.coords.latitude;
                    var lng = position.coords.longitude;
                    
                    // ì¢Œí‘œë¥¼ ì£¼ì†Œë¡œ ë³€í™˜ (Reverse Geocoding)
                    geocoder.coord2Address(lng, lat, function(result, status) {
                        if (status === kakao.maps.services.Status.OK) {
                            // ë„ë¡œëª… ì£¼ì†Œê°€ ìˆìœ¼ë©´ ë„ë¡œëª…, ì—†ìœ¼ë©´ ì§€ë²ˆ ì£¼ì†Œ ì‚¬ìš©
                            var detailAddr = !!result[0].road_address ? result[0].road_address.address_name : result[0].address.address_name;
                            
                            // ì…ë ¥ì°½ì— ì£¼ì†Œ ë„£ê¸°
                            document.getElementById('startKeyword').value = "ë‚´ í˜„ì¬ ìœ„ì¹˜"; 
                            
                            // ì§€ë„ì— ë§ˆì»¤ í‘œì‹œ ë° ë°ì´í„° ì €ì¥
                            setPoint('start', lat, lng, "ë‚´ í˜„ì¬ ìœ„ì¹˜ (" + detailAddr + ")");
                            
                            alert("ì¶œë°œì§€ê°€ í˜„ì¬ ìœ„ì¹˜ë¡œ ì„¤ì •ë˜ì—ˆìŠµë‹ˆë‹¤.\n(" + detailAddr + ")");
                        }
                    });

                }, function(error) {
                    console.error(error);
                    alert("ìœ„ì¹˜ ì •ë³´ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ë¸Œë¼ìš°ì € ìœ„ì¹˜ ê¶Œí•œì„ í™•ì¸í•´ì£¼ì„¸ìš”.");
                });
            } else {
                alert("ì´ ë¸Œë¼ìš°ì €ëŠ” ìœ„ì¹˜ ì •ë³´ë¥¼ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.");
            }
        }

        // [ê¸°ëŠ¥ 2] í‚¤ì›Œë“œ ê²€ìƒ‰
        function searchLocation(type) {
            var keyword = document.getElementById(type + 'Keyword').value;
            if (!keyword.trim()) {
                alert('ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”!');
                return;
            }

            ps.keywordSearch(keyword, function(data, status) {
                if
